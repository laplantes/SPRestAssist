"use strict";const axiosConfigMin={headers:{Accept:"application/json;odata=minimalmetadata","content-type":"application/json;odata=verbose"}},axiosConfigVerbose={headers:{Accept:"application/json;odata=verbose","content-type":"application/json;odata=verbose"}},getListItemEntityTypeFullName=(e,t)=>{try{return axios.get(`${e}/_api/web/lists/getByTitle('${t}')`)}catch(e){console.log("There was an issue reading the listItemEntityTypeFullName. The error is: ",e)}},getDigestValue=e=>{try{return axios.post(`${e}/_api/contextinfo`)}catch(e){console.log("There was an issue reading the listItemEntityTypeFullName. The error is: ",e)}};export const getItems=e=>{const{url:t,list:s,action:a,query:i="",verbose:r=!1}=e;let o;return r?o=JSON.parse(JSON.stringify(axiosConfigVerbose)):JSON.parse(JSON.stringify(axiosConfigMin)),axios.get(`${t}/_api/web/lists/getByTitle('${s}')/${a}?${i}`)};export const createItem=async e=>{const{url:t,list:s,data:a,verbose:i=!1}=e;let r;i?r=JSON.parse(JSON.stringify(axiosConfigVerbose)):JSON.parse(JSON.stringify(axiosConfigMin));const o=await getListItemEntityTypeFullName(t,s),n=await getDigestValue(t),p=`{ '__metadata': { 'type': '${o.data.ListItemEntityTypeFullName}' }, ${a} }`;return r.headers["X-RequestDigest"]=n.data.FormDigestValue,axios.post(`${t}/_api/web/lists/getByTitle('${s}')/items`,p,r)};export const updateItem=async e=>{const{url:t,list:s,data:a,updateId:i,etag:r="*",verbose:o=!1}=e;let n;o?n=JSON.parse(JSON.stringify(axiosConfigVerbose)):JSON.parse(JSON.stringify(axiosConfigMin));const p=await getListItemEntityTypeFullName(t,s),l=await getDigestValue(t),g=`{ '__metadata': { 'type': '${p.data.ListItemEntityTypeFullName}' }, ${a} }`;return n.headers["X-RequestDigest"]=l.data.FormDigestValue,n.headers["IF-MATCH"]=`${r}`,n.headers["X-HTTP-METHOD"]="MERGE",axios.post(`${t}/_api/web/lists/getByTitle('${s}')/items(${i})`,g,n)};export const deleteItem=async e=>{const{url:t,list:s,itemId:a,etag:i="*",verbose:r=!1}=e;let o;r?o=JSON.parse(JSON.stringify(axiosConfigVerbose)):JSON.parse(JSON.stringify(axiosConfigMin));const n=await getDigestValue(t);return o.headers["X-RequestDigest"]=n.data.FormDigestValue,o.headers["IF-MATCH"]=`${i}`,axios.delete(`${t}/_api/web/lists/getByTitle('${s}')/items(${a})`,o)};export const getCurrentUserProps=e=>{const{url:t,selectedProperty:s,verbose:a=!1}=e;let i;return a?i=JSON.parse(JSON.stringify(axiosConfigVerbose)):JSON.parse(JSON.stringify(axiosConfigMin)),axios.get(`${t}/_api/SP.UserProfiles.PeopleManager/GetMyProperties/${s}`)};export const getCurrentUserGroups=async e=>(await axios.get(`${e.url}/_api/web/currentuser/?$expand=Groups&$select=Groups`)).data.Groups;export const verifyCurrentUserGroupMembership=async e=>{const t=await axios.get(`${e.url}/_api/web/currentuser/?$expand=Groups&$select=Groups`);let s=[];return t.data.Groups.forEach((e=>s.push(e.Title))),s.includes(`${e.groupName}`)};
//# sourceMappingURL=sprestassist.min.js.map
